<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="RecipesAppApp.Views.HomePageView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:RecipesAppApp.Models"
    xmlns:vm="clr-namespace:RecipesAppApp.ViewModels"
    x:DataType="vm:HomePageViewModel"
    xmlns:classes="clr-namespace:RecipesAppApp.Classes"
    xmlns:sfbutton="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
    BackgroundColor="Wheat"
    Shell.BackgroundColor="Wheat"
    Title="HomePageView">
    <ScrollView x:Name="scrlview">
        <StackLayout>
            <Grid ColumnDefinitions="4*,*,2*"  MaximumHeightRequest="500" MinimumHeightRequest="30">
                <Entry Grid.Column="0" PlaceholderColor="#a0522d" Placeholder="Search by player name" Margin="10,0,0,12" Text="{Binding SearchedName}" HorizontalOptions="Start" WidthRequest="220" HeightRequest="40" ClearButtonVisibility="WhileEditing" VerticalOptions="Start"/>
                <ImageButton Grid.Column="1" RotationX="{Binding FlipPicker}" Source="pickericon.png" Command="{Binding ShowAllergiesCommand}" WidthRequest="30" HeightRequest="30" Margin="50,8,0,50" VerticalOptions="Start"/>
                <Label Grid.Column="2" Text="Allergies" WidthRequest="55" Margin="0,13,0,0">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding ShowAllergiesCommand}"/>
                </Label.GestureRecognizers>
                </Label>
                <CollectionView Margin="20,40,0,0" ItemsSource="{Binding AllergiesList}" BackgroundColor="Wheat" MinimumHeightRequest="35" MaximumHeightRequest="420" MinimumWidthRequest="175" HorizontalOptions="Start" Grid.Column="0" Grid.ColumnSpan="3" IsVisible="{Binding IsAllergiesVisble}">
                        <CollectionView.Header>
                            <Border Margin="8,0,0,0" Stroke="#deb887" HeightRequest="31" StrokeShape="RoundRectangle 2,2,2,2" IsVisible="{Binding IsYourAllergiesVisble}" VerticalOptions="Start" WidthRequest="125" HorizontalOptions="Start">
                                <HorizontalStackLayout Margin="0,2,0,2">
                                <!--<sfbutton:SfCheckBox
                                    IsThreeState="True"
                                    Margin="-9,0,0,0"
                                    UncheckedColor="#a0522d"
                                    CheckedColor="#a0522d"
                                    VerticalOptions="Center"
                                    StateChanged="YourAllergiesCheck"
                                    IsChecked="{Binding IsYourAllergiesChecked}"/>-->
                                <CheckBox Margin="-9,0,0,0" Color="#a0522d" IsChecked="{Binding IsYourAllergiesChecked}" VerticalOptions="Center" CheckedChanged="AllergiesCheckChanged"/>
                                    <Label Margin="-8,0,0,0" Grid.Column="1" TextColor="#a0522d" Text="Your allergies" VerticalOptions="Center"/>
                                </HorizontalStackLayout>
                            </Border>
                        </CollectionView.Header>
                    <CollectionView.ItemsLayout>
                        <GridItemsLayout
                            Orientation="Vertical"
                            Span="3"
                            HorizontalItemSpacing="5"
                            VerticalItemSpacing="5">
                        </GridItemsLayout>
                    </CollectionView.ItemsLayout>
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="classes:UserAllergyWithIsChecked">
                            <Border Stroke="#deb887"  WidthRequest="105" MaximumHeightRequest="30" VerticalOptions="Start" StrokeShape="RoundRectangle 2,2,2,2">
                                <HorizontalStackLayout Margin="0,2,0,2">
                                    <!--<sfbutton:SfCheckBox
                                        x:Name="allergiesCheckBox"
                                        IsThreeState="False"
                                        Margin="-9,0,0,0"
                                        UncheckedColor="#a0522d"
                                        CheckedColor="#a0522d"
                                        VerticalOptions="Center"
                                        StateChanged="AllergiesStateChanged"/>-->
                                    <CheckBox Margin="-9,0,0,0" Color="#a0522d" IsChecked="{Binding IsChecked}" VerticalOptions="Center" CheckedChanged="AllergiesCheckChanged" />
                                        <Label Margin="-8,0,0,0" Grid.Column="1" TextColor="#a0522d" Text="{Binding AllergyName}" VerticalOptions="Center"  />
                                    </HorizontalStackLayout>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
            </Grid>
            <Label FontAttributes="Bold" Text="Search results" IsVisible="{Binding InSearch}" />
            <CollectionView
                Margin="10"
                ItemsLayout="VerticalGrid, 3"
                x:Name="searchCollectionView"
                IsVisible="{Binding InSearch}"
                ItemsSource="{Binding SearchedBarList}"
                SelectedItem="{Binding SelectedRecipe}"
                SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
                            Padding="20"
                            HorizontalOptions="FillAndExpand"
                            VerticalOptions="Center">
                            <Image
                                Grid.Row="0"
                                Grid.Column="0"
                                Aspect="Fill"
                                HeightRequest="150"
                                Source="{Binding RecipeImage}"
                                WidthRequest="100" />
                            <Label
                                Grid.Row="1"
                                Grid.Column="0"
                                Text="{Binding RecipesName}" 
                                WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <Label
                IsVisible="{Binding IsLoggedSearch}"
                FontAttributes="Bold"
                Text="Your recipes" />
            <CollectionView
IsVisible="{Binding IsLoggedSearch}"
ItemsSource="{Binding YourRecipes}"
SelectedItem="{Binding SelectedRecipe}"
SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
            Padding="20"
            HorizontalOptions="FillAndExpand"
            VerticalOptions="Center">
                            <Image
                Aspect="Fill"
                HeightRequest="150"
                Source="{Binding RecipeImage}"
                WidthRequest="100" />
                            <Label Text="{Binding RecipesName}" WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="Kosher Recipes" IsVisible="{Binding NotInSearch}" />
            <CollectionView
     IsVisible="{Binding NotInSearch}"
     ItemsSource="{Binding KosherRecipes}"
     SelectedItem="{Binding SelectedRecipe}"
     SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
                 Padding="20"
                 HorizontalOptions="FillAndExpand"
                 VerticalOptions="Center">
                            <Image
                     Aspect="Fill"
                     HeightRequest="150"
                     Source="{Binding RecipeImage}"
                     WidthRequest="100"
                                />
                            <Label Text="{Binding RecipesName}" WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="Japanese Food" IsVisible="{Binding NotInSearch}" />
            <CollectionView
     IsVisible="{Binding NotInSearch}"
     ItemsSource="{Binding JapaneseRecipes}"
     SelectedItem="{Binding SelectedRecipe}"
     SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
                 Padding="20"
                 HorizontalOptions="FillAndExpand"
                 VerticalOptions="Center">
                            <Image
                     Aspect="Fill"
                     HeightRequest="150"
                     Source="{Binding RecipeImage}"
                     WidthRequest="100" />
                            <Label Text="{Binding RecipesName}" WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="Top Ten Most Made Recipes" IsVisible="{Binding NotInSearch}" />
            <CollectionView
                IsVisible="{Binding NotInSearch}"
                ItemsSource="{Binding MostPopularRecipes}"
                SelectedItem="{Binding SelectedTopTenRecipe}"
                SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="classes:TopTenList">
                        <VerticalStackLayout
                            Padding="20"
                            HorizontalOptions="FillAndExpand"
                            VerticalOptions="Center">
                            <Grid
                                ColumnDefinitions="0.5*,*"
                                RowDefinitions="*,0.25*">
                            <Image
                                Grid.Column="1"
                                Aspect="Fill"
                                HeightRequest="150"
                                Source="{Binding RecipeImage}"
                                WidthRequest="100" />
                                <Label Grid.Row="1" Grid.Column="1" Text="{Binding RecipeName}" WidthRequest="100"/>
                                <Label FontSize="40" VerticalOptions="Center" Grid.RowSpan="2">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="{Binding RecipePlace}"/>
                                            <Span Text=". "/>
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup>
                                        <VisualState Name="Selected">
                                            <VisualState.Setters>
                                                <Setter Property="BackgroundColor" Value="Wheat" />
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="French Food" IsVisible="{Binding NotInSearch}" />
            <CollectionView IsVisible="{Binding NotInSearch}" ItemsSource="{Binding FrenchRecipes}" SelectedItem="{Binding SelectedRecipe}" SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
                 Padding="20"
                 HorizontalOptions="FillAndExpand"
                 VerticalOptions="Center">
                            <Image
                     Aspect="Fill"
                     HeightRequest="150"
                     Source="{Binding RecipeImage}"
                     WidthRequest="100" />
                            <Label Text="{Binding RecipesName}" WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="Deserts" IsVisible="{Binding NotInSearch}" />
            <CollectionView IsVisible="{Binding NotInSearch}" ItemsSource="{Binding Deserts}" SelectedItem="{Binding SelectedRecipe}" SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
                 Padding="20"
                 HorizontalOptions="FillAndExpand"
                 VerticalOptions="Center">
                            <Image
                     Aspect="Fill"
                     HeightRequest="150"
                     Source="{Binding RecipeImage}"
                     WidthRequest="100" />
                            <Label Text="{Binding RecipesName}" WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="Italian Food" IsVisible="{Binding NotInSearch}" />
            <CollectionView IsVisible="{Binding NotInSearch}" ItemsSource="{Binding ItalianRecipes}" SelectedItem="{Binding SelectedRecipe}" SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Recipe">
                        <VerticalStackLayout
                 Padding="20"
                 HorizontalOptions="FillAndExpand"
                 VerticalOptions="Center">
                            <Image
                     Aspect="Fill"
                     HeightRequest="150"
                     Source="{Binding RecipeImage}"
                     WidthRequest="100" />
                            <Label Text="{Binding RecipesName}" WidthRequest="100"/>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="Wheat" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
            <Label FontAttributes="Bold" Text="Top Ten Most Rated Recipes" IsVisible="{Binding NotInSearch}" />
            <CollectionView IsVisible="{Binding NotInSearch}" ItemsSource="{Binding TopRatedRecipes}" SelectedItem="{Binding SelectedTopTenRecipe}" SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="classes:TopTenList">
                        <VerticalStackLayout
                 Padding="20"
                 HorizontalOptions="FillAndExpand"
                 VerticalOptions="Center">
                            <Grid
                     ColumnDefinitions="0.5*,*"
                     RowDefinitions="*,0.25*">
                                <Image
                     Grid.Column="1"
                     Aspect="Fill"
                     HeightRequest="150"
                     Source="{Binding RecipeImage}"
                     WidthRequest="100" />
                                <Label Grid.Row="1" Grid.Column="1" Text="{Binding RecipeName}" WidthRequest="100"/>
                                <Label FontSize="40" VerticalOptions="Center" Grid.RowSpan="2">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="{Binding RecipePlace}"/>
                                            <Span Text=". "/>
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <VisualStateManager.VisualStateGroups>
                                    <VisualStateGroup>
                                        <VisualState Name="Selected">
                                            <VisualState.Setters>
                                                <Setter Property="BackgroundColor" Value="Wheat" />
                                            </VisualState.Setters>
                                        </VisualState>
                                    </VisualStateGroup>
                                </VisualStateManager.VisualStateGroups>
                            </Grid>
                        </VerticalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" />
                </CollectionView.ItemsLayout>
            </CollectionView>
        </StackLayout>
    </ScrollView>
</ContentPage>